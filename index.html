function updateColorsByStyle(styleId, colorId) {
    const selectedStyle = document.getElementById(styleId).value;
    const colorChoice = choicesInstances[colorId];
    
    if (!selectedStyle) {
        colorChoice.clearChoices();
        colorChoice.setChoices([{ value: '', label: 'SELECT STYLE FIRST', selected: true }], 'value', 'label', true);
        return;
    }

    // 重點改動：精確過濾該款式在資料庫中對應的顏色
    const availableColors = rawStyleData
        .filter(row => row[0].toString().trim() === selectedStyle.trim()) // 比對款式名稱
        .map(row => row[1].toString().trim()) // 抓取對應顏色
        .filter(String); // 去除空白
    
    const uniqueColors = [...new Set(availableColors)].sort();

    colorChoice.clearChoices();
    
    if (uniqueColors.length > 0) {
        const choicesList = uniqueColors.map(c => ({ value: c, label: c }));
        colorChoice.setChoices(choicesList, 'value', 'label', true);
        
        // 如果這個款式只有一個顏色，直接幫妳選好
        if (uniqueColors.length === 1) {
            colorChoice.setChoiceByValue(uniqueColors[0]);
        } else {
            colorChoice.setChoiceByValue(''); // 多個顏色時讓妳手選
        }
    } else {
        colorChoice.setChoices([{ value: '', label: 'NO COLOR FOUND', selected: true }], 'value', 'label', true);
    }
}
